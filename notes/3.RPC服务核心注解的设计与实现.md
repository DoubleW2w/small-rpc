# RPC æœåŠ¡æ ¸å¿ƒæ³¨è§£çš„è®¾è®¡ä¸å®ç°

## ğŸˆS

## ğŸˆT

### æœåŠ¡æä¾›è€…æ³¨è§£

ä¸€ä¸ªæœåŠ¡æä¾›è€…éœ€è¦æä¾›ï¼šã€ŒæœåŠ¡åç§°ã€ã€ã€ŒæœåŠ¡ç‰ˆæœ¬å·ã€ã€ã€ŒæœåŠ¡åœ°å€ã€ã€ã€ŒæœåŠ¡ç«¯å£ã€ã€ã€ŒæœåŠ¡åˆ†ç»„ä¿¡æ¯ã€

- æœåŠ¡åç§°ï¼šæä¾›æœåŠ¡çš„æ¥å£çš„å®Œæ•´ç±»åã€‚
- æœåŠ¡ç‰ˆæœ¬å·ï¼šæ ‡è¯†å½“å‰æœåŠ¡çš„ç‰ˆæœ¬å·
- æœåŠ¡åœ°å€ï¼šæä¾›è€…å‘å¸ƒçš„æœåŠ¡æ‰€åœ¨çš„ç½‘ç»œåœ°å€
- æœåŠ¡ç«¯å£ï¼šæœåŠ¡æä¾›è€…å‘å¸ƒçš„æœåŠ¡æ‰€ç›‘å¬çš„ç«¯å£å·ã€‚
- æœåŠ¡åˆ†ç»„çš„ç›®çš„æ˜¯ä¸ºäº†æœåŠ¡éš”ç¦»

### æœåŠ¡æ¶ˆè´¹è€…æ³¨è§£

ä¸€ä¸ªæœåŠ¡æ¶ˆè´¹è€…éœ€è¦ä»¥ä¸‹éƒ¨åˆ†ä¿¡æ¯ï¼š

- æ³¨å†Œä¸­å¿ƒåœ°å€ï¼šæœåŠ¡æ¶ˆè´¹è€…å»æ³¨å†Œä¸­å¿ƒè®¢é˜…æœåŠ¡
- æ³¨å†Œä¸­å¿ƒç±»å‹ï¼šæœåŠ¡çš„æ³¨å†Œä¸­å¿ƒç±»å‹ã€‚
- è´Ÿè½½å‡è¡¡ç±»å‹ï¼šå½“å­˜åœ¨å¤šä¸ªæœåŠ¡æä¾›è€…æ—¶ï¼Œé€‰æ‹©åˆé€‚çš„è´Ÿè½½å‡è¡¡ç­–ç•¥
- æœåŠ¡åˆ†ç»„ã€ç‰ˆæœ¬å·ï¼šåªæœ‰æœåŠ¡åç§°ã€æœåŠ¡ç‰ˆæœ¬å·ã€æœåŠ¡åˆ†ç»„ä¸æœåŠ¡æä¾›è€…éƒ½åŒ¹é…æ—¶ï¼Œæ‰èƒ½è¿›è¡Œè¿œç¨‹è°ƒç”¨
- åºåˆ—åŒ–ç±»å‹ï¼šåºåˆ—åŒ–çš„æ•°æ®å¯ä»¥åœ¨ç½‘ç»œä¸Šè¿›è¡Œä¼ è¾“
- ä»£ç†æ–¹å¼ï¼š
- è¶…æ—¶æ—¶é—´ï¼šé¿å…é˜»å¡ï¼Œè¶…è¿‡ä¸€å®šæ—¶é—´ï¼Œè‡ªåŠ¨è¿”å›
- æ˜¯å¦å¼‚æ­¥è°ƒç”¨ï¼šåŒæ­¥æˆ–è€…å¼‚æ­¥è°ƒç”¨
- æ˜¯å¦å•å‘è°ƒç”¨

## ğŸˆA

æœåŠ¡æä¾›è€…æ³¨è§£

```java
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
public @interface RpcService {
    /** æ¥å£çš„Class */
    Class<?> interfaceClass() default void.class;

    /** æ¥å£çš„ClassName */
    String interfaceClassName() default "";

    /** ç‰ˆæœ¬å· */
    String version() default "1.0.0";

    /** æœåŠ¡åˆ†ç»„ï¼Œé»˜è®¤ä¸ºç©º */
    String group() default "";
}

```



æœåŠ¡æ¶ˆè´¹è€…æ³¨è§£

```java
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.FIELD)
public @interface RpcReference {
  /** ç‰ˆæœ¬å· */
  String version() default "1.0.0";

  /** æ³¨å†Œä¸­å¿ƒç±»å‹, ç›®å‰çš„ç±»å‹åŒ…å«ï¼šzookeeperã€nacosã€etcdã€consul */
  String registryType() default "zookeeper";

  /** æ³¨å†Œåœ°å€ */
  String registryAddress() default "127.0.0.1:2181";

  /** è´Ÿè½½å‡è¡¡ç±»å‹ï¼Œé»˜è®¤åŸºäºZKçš„ä¸€è‡´æ€§Hash */
  String loadBalanceType() default "zkconsistenthash";

  /** åºåˆ—åŒ–ç±»å‹ï¼Œç›®å‰çš„ç±»å‹åŒ…å«ï¼šprotostuffã€kryoã€jsonã€jdkã€hessian2ã€fst */
  String serializationType() default "protostuff";

  /** è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤5s */
  long timeout() default 5000;

  /** æ˜¯å¦å¼‚æ­¥æ‰§è¡Œ */
  boolean async() default false;

  /** æ˜¯å¦å•å‘è°ƒç”¨ */
  boolean oneway() default false;

  /** ä»£ç†çš„ç±»å‹ï¼Œjdkï¼šjdkä»£ç†ï¼Œ javassist: javassistä»£ç†, cglib: cglibä»£ç† */
  String proxy() default "jdk";

  /** æœåŠ¡åˆ†ç»„ï¼Œé»˜è®¤ä¸ºç©º */
  String group() default "";
}
```

```java
@RpcService(interfaceClassName="xxxx.xxx.xx", version="1.0.0", group="cal")
@Service
public class MyServiceImpl implements MyService{
    //æ­¤å¤„çœç•¥
}
```

```java
@Service 
public class ConsumerServiceImpl implements ConsumerService{
    @RpcReference(registryType = "nacos", registryAddress = "127.0.0.1:2181", loadBalanceType = "zkconsistenthash", version = "1.0.0", group = "cal", serializationType = "protostuff", proxy = "cglib", timeout = 30000, async = true, oneway=false)
    private ConsumerRpcService consumerRpcService;
     //æ­¤å¤„çœç•¥
}
```

## ğŸˆR

åœ¨ RPC ä¸­ï¼ŒæœåŠ¡æ¶ˆè´¹è€…å’ŒæœåŠ¡æä¾›è€…æ‰€éœ€è¦çš„ä¿¡æ¯æ˜¯ä»€ä¹ˆã€‚